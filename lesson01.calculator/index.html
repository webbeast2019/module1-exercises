<!DOCTYPE html>
<html lang="en">
<head>
    <title>Web Calculator</title>
    <meta charset="utf-8">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <style>
        header{
            text-align: center;
        }
        #screen{
            display: block;
            width:400px;
            height: 100px;
            font-size: 30px;


        }
        #clear{
            width:400px;

        }
        main{
            width:700px;
            height: 700px;
          
            margin:auto;
            padding-left: 250px;
           align-content: center;
            
        }
        button{
            border-radius: 5px;
            font-size: 30px;

        
        }
        .calculator{
            position: absolute;
            margin: auto;
            
        }
        
        .numbers{
            position: absolute;
            display:grid;
            border: black solid;
            width:400px;
            height:400px;
            grid-template-columns:repeat(4,1fr);
            grid-template-rows:repeat(4,1fr); 
           
            
        }


    </style>
</head>
<body>
    <header>
        <h1>Web Calculator</h1>
    </header>
    <main>
      <div class="calculator">
        <input type="text" id="screen" value="" disabled />
        <span>
            <button type="button" id= "clear" onclick="clearScreen()"> C</button>
        </span>
        <div class="numbers">
        <button type="button" id = "seven"onclick="showAndProccesInput(this)"  value="7">7</button>
        <button type="button" id= "eight" onclick="showAndProccesInput(this)" value="8">8</button>
        <button type="button" id= "nine"  onclick="showAndProccesInput(this)" value="9">9</button>
        <button id = "add" class = "ops"  value='+'>+</button>
        <button type="button" id= "four"  onclick="showAndProccesInput(this)" value="4">4</button>
        <button type="button" id= "five"  onclick="showAndProccesInput(this)" value="5">5</button>
        <button type="button" id = "six"  onclick="showAndProccesInput(this)" value="6">6</button>
        <button id = "sub" class = "ops" value="-">-</button>
        <button type="button" id = "one"  onclick="showAndProccesInput(this)" value="1">1</button>
        <button type="button" id = "two"  onclick="showAndProccesInput(this)"  value="2">2</button>
        <button type="button" id = "three"  onclick="showAndProccesInput(this)" value="3">3</button>
        <button id = "mltpy" class = "ops"  value='*'>*</button>
        <button type="button" id = "zero"  onclick="showAndProccesInput(this)" value="0">0</button>
        <button type="button" id = "dot"  onclick="showAndProccesInput(this)" value=".">.</button>
        <button type="button" id= "equal"  value = "=">=</button>
        <button id = "divert" class = "ops"   value ='/' >/</button>
        </div>
    
    </div>
    </main>
    <script>

        document.getElementById('equal').addEventListener('click',calculate);
        let clearFlag = false;
        let operation = '';
        let expr = [];
        const opsSigns = ['-','+','*','/'];
        const nums = ['0','1','2','3','4','5','6','7','8','9'];
        /*calculate expression after user press on '='*/
        const opsClass = document.getElementsByClassName("ops");
        for(let  i = 0; i<opsClass.length ;i++){
            opsClass[i].addEventListener('click',(element)=>{
            operation = element.value;
             showAndProccesInput(opsClass[i]);
         })

        }
        
        function calculate(element){
            let result = '';
            for(let i = 0 ; i<expr.length -1 ; i= i+2){
                let opr = expr[i+1];
                num1 = result !=''? result :parseFloat(expr[i]);
                num2 = parseFloat(expr[i+2]);
                if(opr ==='+'){
                    result = num1+num2
                    
                }
                else if(opr ==='-')
                {
                    result = num1-num2
                }
                else if(opr ==='*'){
                    result = num1*num2
                }
                else{
                    result = num1/num2
                }

                }
            
            document.getElementById('screen').value = result;
            clearFlag=true;
            
        }
        /*called for every number or operation click event*/
        function showAndProccesInput(element){
            displayElem = document.getElementById('screen'); 
            if(clearFlag){
                displayElem.value = "";
                clearScreen();
                
            }
            let newVal = element.value;
            let lastValue = expr[expr.length-1];
           if(checkInputValidity(newVal)){ 
                if(opsSigns.indexOf(newVal) ==-1 && opsSigns.indexOf(lastValue)==-1
                && expr.length>0){
                    expr[expr[expr.length - 1]] += newVal;
                }
                else{
                  expr.push(newVal);
                }
    
                 document.getElementById('screen').value += newVal;

            }
        }


        function checkInputValidity(newVal){
            let lastChar = expr[expr.length - 1];
            let isExprValid = true;
            let isLastCharOps = opsSigns.indexOf(lastChar) !=-1;
            let isNewValOps = opsSigns.indexOf(newVal) !=-1;
            if(expr.length>0){
                if(isLastCharOps && isNewValOps){
                    isExprValid= false;
             }
             if(isLastCharOps){
                    if(newVal =='.'){
                      isExprValid= false;
                 }
              }
                if(isNewValOps){
                 if(lastChar=='.'){
                    isExprValid =  false;
                 }
             }

            }
         return isExprValid;
        }
        
        function clearScreen(){
            document.getElementById("screen").value = '';
            clearFlag=false;
            operation = '';
            expr=[];
        }
    
    </script>

</body>
</html>